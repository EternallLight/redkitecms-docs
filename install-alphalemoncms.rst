AlphaLemon CMS installation procedure
=====================================

AlphaLemon CMS is distributed using `composer`_, so the first thing to do is to get
composer.

.. note:

    This tutorial explains how to install AlphaLemon CMS into an existing project
    which dependencies are managed by composer.

    To start an AlphaLemon CMS project from the scratch, you should use the
    `AlphaLemon CMS sandbox`_.


Composer installation
---------------------

To install composer, move to the root folder of your application then run the following
command to download composer:

.. code-block:: text

    curl -s http://getcomposer.org/installer | php


Add AlphaLemon to your composer.json file
-----------------------------------------

Open your composer .json file and add the following code:

.. code-block:: text

    {
        "repositories": [
            {
                "type": "composer",
                "url": "http://apps.alphalemon.com/"
            }
        ],
        "require": {
            "alphalemon/alphalemon-cms-bundle": "dev-master",
            "alphalemon/alphalemon-cms-installer-bundle": "dev-master"
        }
    }

Install AlphaLemon CMS
----------------------

To install run the following command

.. code-block:: text

    php composer.phar update


AlphaLemon CMS setup
--------------------

AlphaLemonCMS requires several steps to be accomplished to properly setup the CMS itself. Luckily
the **AlphaLemonCmsInstallerBundle** will do all the job for you, providing a web installer interface
or an interactive symfony2 command to install AlphaLemonCMS.


Installing from the console
---------------------------

Installing AlphaLemonCMS from the console is really easy:

.. code-block:: text

    app/console alphalemon:install-cms

This will run the interactive command. Provide the required information and you are done! Point
your browser at

.. code-block:: text

    http://localhost/alcms.php/backend/en/index

to start using AlphaLemonCMS.

Installing using the web interface
----------------------------------

To start AlphaLemon CMS installation, simply point your browser at:

.. code-block:: text

    http://localhost/app_dev.php/install

Provide the required information and you are done! After the process ended, a web
page is rendered with the process summary and gives you the information required
to start.

Permissions
-----------
Don't forget to setup the permissions on the installation folder as explained in the
`symfony2 setup and configuration tutorial`_

Custom deploy bundle
--------------------
During the installation process, the wizard or the web interface asks you to specify 
the **Deploy bundle**.

If you specificy a deploy bundle different than the proposed one, you must change manually
the controller that handles all the routes generated by AlphaLemon CMS.

To achieve that task, add a **WebSiteController.php** under your deploy bundle's Controller 
folder, or simply rename the default one to **WebSiteController.php**, then change the 
controller as follows:

.. code-block:: php

    use AlphaLemon\ThemeEngineBundle\Core\Rendering\Controller\FrontendController;

    class WebSiteController extends FrontendController
    {
    }

At the moment the controller name is hardcoded, but this will chang in the future,
just adding a configurable parameter.


What to do if something goes wrong
----------------------------------
The AlphaLemon CMS installer changes some configuration files of your application,
so, if something goes wrong during the setup, you could have problems to run the install
process again, due to the changes mentioned above.

Luckily, the installer backup those files, so to fix the problem, you have simply to
remove the files changed by the installer and restore the backupped ones.

Those files are:

.. code-block:: text

    app/AppKernel.php
    app/config/config.yml
    app/config/routing.yml

For all of those files, the installer creates a specular copy with the **.bak** extension
before changing the file itself.

If the bak file does not exist, it means that the file has not been changed yet.


.. _`composer`: http://getcomposer.org
.. _`AlphaLemon CMS sandbox`: http://github.com/AlphaLemonCmsSandbox
.. _`symfony2 setup and configuration tutorial`: http://symfony.com/doc/current/book/installation.html#configuration-and-setup
